version: 1.0
runtime: nodejs22
build:
  commands:
    - corepack enable
    - pnpm install --frozen-lockfile
    - pnpm build
    - cp -r public .next/standalone/public
    - cp -r .next/static .next/standalone/.next/static
run:
  command: node .next/standalone/server.js
  network:
    port: 3000
  env:
    - name: NODE_ENV
      value: "production"
    - name: PORT
      value: "3000"
    - name: HOSTNAME
      value: "0.0.0.0"
  health_check:
    protocol: TCP
    port: 3000
    interval: 10
    timeout: 5
    healthy_threshold: 1
    unhealthy_threshold: 3
